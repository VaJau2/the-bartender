[gd_scene load_steps=47 format=3 uid="uid://bbvon43a7hnst"]

[ext_resource type="Texture2D" uid="uid://b18x8vlddqeud" path="res://assets/sprites/characters/pony_shadow.png" id="1_cfspk"]
[ext_resource type="Texture2D" uid="uid://bcm8f8d4h1r6w" path="res://assets/sprites/characters/base.png" id="1_mapcr"]
[ext_resource type="Script" uid="uid://d1ctisw8kxryp" path="res://assets/scripts/controllers/movement/movementController.gd" id="2_8wket"]
[ext_resource type="Texture2D" uid="uid://digw164pwr3dv" path="res://assets/sprites/characters/items/bag.png" id="3_nrt7u"]
[ext_resource type="Script" uid="uid://dxiwao0oi3jq3" path="res://assets/scripts/controllers/movement/movementState.gd" id="3_o4xot"]
[ext_resource type="Script" uid="uid://csp1utd40ubch" path="res://assets/scripts/controllers/animationController.gd" id="4_o4xot"]
[ext_resource type="Script" uid="uid://c0avwigavpdu5" path="res://assets/scripts/controllers/steps/stepsController.gd" id="5_yuviu"]
[ext_resource type="Script" uid="uid://cqrlqmbvhk1x3" path="res://assets/scripts/controllers/steps/stepData.gd" id="6_1lg8h"]
[ext_resource type="AudioStream" uid="uid://dymbri0f4cpbt" path="res://assets/audio/steps/stone/StoneStepRun1.wav" id="7_cfspk"]
[ext_resource type="AudioStream" uid="uid://d3j6j21q6b5al" path="res://assets/audio/steps/stone/StoneStepRun2.wav" id="8_gcnsu"]
[ext_resource type="AudioStream" uid="uid://h5wxna8rnmcl" path="res://assets/audio/steps/stone/StoneStepRun3.wav" id="9_75x00"]
[ext_resource type="AudioStream" uid="uid://drgatqqnlino8" path="res://assets/audio/steps/stone/StoneStep1.wav" id="10_6sj3t"]
[ext_resource type="AudioStream" uid="uid://by100kpgatr7k" path="res://assets/audio/steps/stone/StoneStep2.wav" id="11_varnu"]
[ext_resource type="AudioStream" uid="uid://5u8eo4orxbyy" path="res://assets/audio/steps/stone/StoneStep3.wav" id="12_4bg8u"]
[ext_resource type="AudioStream" uid="uid://c2uuoflv4813d" path="res://assets/audio/steps/dirt/stepDirtRun1.wav" id="13_5qkwf"]
[ext_resource type="AudioStream" uid="uid://buja35smiatu2" path="res://assets/audio/steps/dirt/stepDirtRun2.wav" id="14_l6pfb"]
[ext_resource type="AudioStream" uid="uid://gt8u53d06fcg" path="res://assets/audio/steps/dirt/stepDirtRun3.wav" id="15_v85ge"]
[ext_resource type="AudioStream" uid="uid://dkht2khyuox4y" path="res://assets/audio/steps/dirt/stepDirt1.wav" id="16_bpsyi"]
[ext_resource type="AudioStream" uid="uid://bpjk7tlo7hgsy" path="res://assets/audio/steps/dirt/stepDirt2.wav" id="17_c3thp"]
[ext_resource type="AudioStream" uid="uid://dvmkpd6l5pusd" path="res://assets/audio/steps/dirt/stepDirt3.wav" id="18_7twir"]
[ext_resource type="Script" uid="uid://bb0o5flqn57bg" path="res://assets/scripts/controllers/steps/materialChecker.gd" id="19_1lg8h"]
[ext_resource type="AudioStream" uid="uid://b4bhq77wkjox" path="res://assets/audio/steps/grass/stepGrassRun1.wav" id="20_bpsyi"]
[ext_resource type="AudioStream" uid="uid://d2ex6fnvwgkr8" path="res://assets/audio/steps/grass/stepGrassRun2.wav" id="21_c3thp"]
[ext_resource type="AudioStream" uid="uid://dwjkafl3u2iyp" path="res://assets/audio/steps/grass/stepGrassRun3.wav" id="22_7twir"]
[ext_resource type="AudioStream" uid="uid://c2o2b5gidvxn8" path="res://assets/audio/steps/grass/stepGrass1.wav" id="23_nrt7u"]
[ext_resource type="AudioStream" uid="uid://dsti6g36gv6cr" path="res://assets/audio/steps/grass/stepGrass2.wav" id="24_6ondm"]
[ext_resource type="AudioStream" uid="uid://cc43gf307dwq5" path="res://assets/audio/steps/grass/stepGrass3.wav" id="25_6haik"]
[ext_resource type="AudioStream" uid="uid://bofkoqxcxu0h2" path="res://assets/audio/steps/water/stepWaterFast1.wav" id="26_2kgtx"]
[ext_resource type="AudioStream" uid="uid://ny1mr4dtklpe" path="res://assets/audio/steps/water/stepWaterFast2.wav" id="27_kmw3l"]
[ext_resource type="AudioStream" uid="uid://c67ccjkkgm006" path="res://assets/audio/steps/water/stepWaterFast3.wav" id="28_51m1h"]
[ext_resource type="Script" uid="uid://cwlfnhcr8hagj" path="res://assets/scripts/characters/stepSpawner.gd" id="30_c3thp"]
[ext_resource type="PackedScene" uid="uid://cahq5mhin12os" path="res://objects/effects/water-step.tscn" id="31_7twir"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_l51np"]
size = Vector2(23.5, 4)

[sub_resource type="Animation" id="Animation_1ds1p"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("bag:frame")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [0]
}

[sub_resource type="Animation" id="Animation_o4xot"]
resource_name = "idle"
length = 1.5
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.8, 0.9, 1.43333),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [0, 1, 0, 0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("bag:frame")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [0]
}

[sub_resource type="Animation" id="Animation_y4six"]
resource_name = "idle-drunk"
length = 0.4
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.133333, 0.266667),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 1,
"values": [2, 3, 4]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("bag:frame")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [0]
}

[sub_resource type="Animation" id="Animation_7twir"]
resource_name = "run"
length = 0.8
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [24, 25, 26, 27, 28, 29, 30, 31, 24]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("bag:frame")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [24, 25, 26, 27, 28, 29, 30, 31, 28]
}

[sub_resource type="Animation" id="Animation_o31xw"]
resource_name = "sit"
length = 1.5
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.733333, 0.8),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 1,
"values": [40, 41, 40]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("bag:frame")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [40]
}

[sub_resource type="Animation" id="Animation_uaewy"]
resource_name = "sleep"
length = 0.2
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [33]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("bag:frame")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [33]
}

[sub_resource type="Animation" id="Animation_mdm7l"]
resource_name = "walk"
length = 0.8
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [8, 9, 10, 11, 12, 13, 14, 15, 8]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("bag:frame")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8),
"transitions": PackedFloat32Array(1, 0.840896, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [8, 9, 10, 11, 12, 13, 14, 15, 8]
}

[sub_resource type="Animation" id="Animation_4xy4a"]
resource_name = "walk-drunk"
length = 0.8
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [16, 17, 18, 19, 20, 21, 22, 23, 16]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("bag:frame")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8),
"transitions": PackedFloat32Array(1, 0.840896, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [8, 9, 10, 11, 12, 13, 14, 15, 8]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_ndjo6"]
_data = {
&"RESET": SubResource("Animation_1ds1p"),
&"idle": SubResource("Animation_o4xot"),
&"idle-drunk": SubResource("Animation_y4six"),
&"run": SubResource("Animation_7twir"),
&"sit": SubResource("Animation_o31xw"),
&"sleep": SubResource("Animation_uaewy"),
&"walk": SubResource("Animation_mdm7l"),
&"walk-drunk": SubResource("Animation_4xy4a")
}

[sub_resource type="Resource" id="Resource_nrt7u"]
script = ExtResource("6_1lg8h")
material_name = 0
walk_sounds = Array[AudioStream]([ExtResource("10_6sj3t"), ExtResource("11_varnu"), ExtResource("12_4bg8u")])
run_sounds = Array[AudioStream]([ExtResource("7_cfspk"), ExtResource("8_gcnsu"), ExtResource("9_75x00")])
metadata/_custom_type_script = "uid://cqrlqmbvhk1x3"

[sub_resource type="Resource" id="Resource_6ondm"]
script = ExtResource("6_1lg8h")
material_name = 1
walk_sounds = Array[AudioStream]([ExtResource("16_bpsyi"), ExtResource("17_c3thp"), ExtResource("18_7twir")])
run_sounds = Array[AudioStream]([ExtResource("13_5qkwf"), ExtResource("14_l6pfb"), ExtResource("15_v85ge")])
metadata/_custom_type_script = "uid://cqrlqmbvhk1x3"

[sub_resource type="Resource" id="Resource_xyefa"]
script = ExtResource("6_1lg8h")
material_name = 2
walk_sounds = Array[AudioStream]([ExtResource("23_nrt7u"), ExtResource("24_6ondm"), ExtResource("25_6haik")])
run_sounds = Array[AudioStream]([ExtResource("20_bpsyi"), ExtResource("21_c3thp"), ExtResource("22_7twir")])
metadata/_custom_type_script = "uid://cqrlqmbvhk1x3"

[sub_resource type="Resource" id="Resource_8om3k"]
script = ExtResource("6_1lg8h")
material_name = 3
walk_sounds = Array[AudioStream]([ExtResource("26_2kgtx"), ExtResource("27_kmw3l"), ExtResource("28_51m1h")])
run_sounds = Array[AudioStream]([ExtResource("26_2kgtx"), ExtResource("27_kmw3l"), ExtResource("28_51m1h")])
metadata/_custom_type_script = "uid://cqrlqmbvhk1x3"

[node name="character" type="CharacterBody2D"]

[node name="shape" type="CollisionShape2D" parent="."]
position = Vector2(0.75, -1)
shape = SubResource("RectangleShape2D_l51np")

[node name="shadow" type="Sprite2D" parent="."]
modulate = Color(1, 1, 1, 0.321569)
position = Vector2(0.999999, 0)
scale = Vector2(0.651163, 1)
texture = ExtResource("1_cfspk")

[node name="sprite" type="Sprite2D" parent="."]
position = Vector2(0, -28)
texture = ExtResource("1_mapcr")
hframes = 8
vframes = 6

[node name="bag" type="Sprite2D" parent="."]
visible = false
position = Vector2(0, -28)
texture = ExtResource("3_nrt7u")
hframes = 8
vframes = 6

[node name="anim" type="AnimationPlayer" parent="."]
libraries = {
&"": SubResource("AnimationLibrary_ndjo6")
}

[node name="movementController" type="Node" parent="."]
script = ExtResource("2_8wket")

[node name="walk" type="Node" parent="movementController"]
script = ExtResource("3_o4xot")
default = true

[node name="sit" type="Node" parent="movementController"]
script = ExtResource("3_o4xot")
idle_anim = "sit"
speed = 0

[node name="sleep" type="Node" parent="movementController"]
script = ExtResource("3_o4xot")
idle_anim = "sleep"
speed = 0

[node name="run" type="Node" parent="movementController"]
script = ExtResource("3_o4xot")
anim = "run"
speed = 220

[node name="drunk" type="Node" parent="movementController"]
script = ExtResource("3_o4xot")
idle_anim = "idle-drunk"
anim = "walk-drunk"
speed = 80

[node name="animationController" type="Node" parent="." node_paths=PackedStringArray("sprites", "anim", "movement_controller")]
script = ExtResource("4_o4xot")
sprites = [NodePath("../sprite"), NodePath("../bag")]
anim = NodePath("../anim")
movement_controller = NodePath("../movementController")

[node name="audi" type="AudioStreamPlayer2D" parent="." node_paths=PackedStringArray("movement_controller")]
max_distance = 200.0
script = ExtResource("5_yuviu")
movement_controller = NodePath("../movementController")
steps_data = Array[ExtResource("6_1lg8h")]([SubResource("Resource_nrt7u"), SubResource("Resource_6ondm"), SubResource("Resource_xyefa"), SubResource("Resource_8om3k")])

[node name="materialChecker" type="Node2D" parent="audi" node_paths=PackedStringArray("parent")]
script = ExtResource("19_1lg8h")
parent = NodePath("../..")

[node name="stepSpawner" type="Node2D" parent="audi" node_paths=PackedStringArray("steps_controller", "movement_controller")]
script = ExtResource("30_c3thp")
prefab = ExtResource("31_7twir")
steps_controller = NodePath("..")
movement_controller = NodePath("../../movementController")

[connection signal="material_changed" from="audi/materialChecker" to="audi" method="on_change_material"]
